<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Closest point on a given flat — project_onto • musicMCT</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Closest point on a given flat — project_onto"><meta name="description" content="Projects a scale onto the nearest point that lies on a target flat
of the hyperplane arrangement. project_onto() determines the target
flat from a list of linearly independent rows in ineqmat which define
the flat. match_flat() determines the target by extrapolating from a
given scale on that flat. Note that while the projection lies on
the desired flat (i.e. it will have all of the necessary 0s in its
sign vector), it will not necessarily belong to any particular color.
(That is, projection doesn't give you control over the 1s and -1s of
the sign vector.)"><meta property="og:description" content="Projects a scale onto the nearest point that lies on a target flat
of the hyperplane arrangement. project_onto() determines the target
flat from a list of linearly independent rows in ineqmat which define
the flat. match_flat() determines the target by extrapolating from a
given scale on that flat. Note that while the projection lies on
the desired flat (i.e. it will have all of the necessary 0s in its
sign vector), it will not necessarily belong to any particular color.
(That is, projection doesn't give you control over the 1s and -1s of
the sign vector.)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">musicMCT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/musicMCT.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/visualizing_higher_dimensions.html">Visualizing Higher Dimensions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/satbq/musicMCT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Closest point on a given flat</h1>
      <small class="dont-index">Source: <a href="https://github.com/satbq/musicMCT/blob/main/R/projection.R" class="external-link"><code>R/projection.R</code></a></small>
      <div class="d-none name"><code>project_onto.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Projects a scale onto the nearest point that lies on a target flat
of the hyperplane arrangement. <code>project_onto()</code> determines the target
flat from a list of linearly independent rows in <code>ineqmat</code> which define
the flat. <code>match_flat()</code> determines the target by extrapolating from a
given scale on that flat. Note that while the projection lies on
the desired flat (i.e. it will have all of the necessary <code>0</code>s in its
sign vector), it will not necessarily belong to any particular <em>color</em>.
(That is, projection doesn't give you control over the <code>1</code>s and <code>-1</code>s of
the sign vector.)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">project_onto</span><span class="op">(</span></span>
<span>  <span class="va">set</span>,</span>
<span>  <span class="va">target_rows</span>,</span>
<span>  ineqmat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_zero <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  edo <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  rounder <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">match_flat</span><span class="op">(</span></span>
<span>  <span class="va">set</span>,</span>
<span>  <span class="va">target_scale</span>,</span>
<span>  start_zero <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ineqmat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  edo <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  rounder <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-set">set<a class="anchor" aria-label="anchor" href="#arg-set"></a></dt>
<dd><p>Numeric vector of pitch-classes in the set</p></dd>


<dt id="arg-target-rows">target_rows<a class="anchor" aria-label="anchor" href="#arg-target-rows"></a></dt>
<dd><p>An integer vector: each integer specifies a row
of <code>ineqmat</code> which helps to determine the target flat. The
rows must be linearly independent.</p></dd>


<dt id="arg-ineqmat">ineqmat<a class="anchor" aria-label="anchor" href="#arg-ineqmat"></a></dt>
<dd><p>Specifies which hyperplane arrangement to consider. By default (or by
explicitly entering "mct") it supplies the standard "Modal Color Theory" arrangements
of <code><a href="makeineqmat.html">getineqmat()</a></code>, but can be set to "white," "roth", "pastel," or "rosy", giving the
<code>ineqmat</code>s of <code><a href="make_white_ineqmat.html">make_white_ineqmat()</a></code>, <code><a href="make_roth_ineqmat.html">make_roth_ineqmat()</a></code>, <code><a href="make_white_ineqmat.html">make_pastel_ineqmat()</a></code>,
and <code><a href="make_roth_ineqmat.html">make_rosy_ineqmat()</a></code>. For other
arrangements, the desired inequality matrix can be entered directly.</p></dd>


<dt id="arg-start-zero">start_zero<a class="anchor" aria-label="anchor" href="#arg-start-zero"></a></dt>
<dd><p>Boolean: should the result be transposed so that its pitch
initial is zero? Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-edo">edo<a class="anchor" aria-label="anchor" href="#arg-edo"></a></dt>
<dd><p>Number of unit steps in an octave. Defaults to <code>12</code>.</p></dd>


<dt id="arg-rounder">rounder<a class="anchor" aria-label="anchor" href="#arg-rounder"></a></dt>
<dd><p>Numeric (expected integer), defaults to <code>10</code>:
number of decimal places to round to when testing for equality.</p></dd>


<dt id="arg-target-scale">target_scale<a class="anchor" aria-label="anchor" href="#arg-target-scale"></a></dt>
<dd><p>A numeric vector which represents a scale
on the target flat.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numeric vector of same length as <code>set</code>, representing
the projection of <code>set</code> onto the flat determined by <code>target_rows</code> or
<code>target_scale</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">minor_triad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">project_onto</span><span class="op">(</span><span class="va">minor_triad</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0 3.0 7.5</span>
<span class="r-in"><span><span class="fu">project_onto</span><span class="op">(</span><span class="va">minor_triad</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0 3.5 7.0</span>
<span class="r-in"><span><span class="fu">project_onto</span><span class="op">(</span><span class="va">minor_triad</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 4 8</span>
<span class="r-in"><span><span class="co"># This last projection results in the perfectly even scale</span></span></span>
<span class="r-in"><span><span class="co"># because that's the only scale on both hyperplanes 1 and 3.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">major_scale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">projected_just_dia</span> <span class="op">&lt;-</span> <span class="fu">match_flat</span><span class="op">(</span><span class="fu"><a href="j.html">j</a></span><span class="op">(</span><span class="va">dia</span><span class="op">)</span>, <span class="va">major_scale</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">projected_just_dia</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.000000  1.946930  3.893860  5.026535  6.973465  8.920395 10.867326</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This is very close to fifth-comma meantone:</span></span></span>
<span class="r-in"><span><span class="va">fifth_comma_meantone</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="meantone_fifth.html">meantone_fifth</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span><span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="vl_dist.html">vl_dist</a></span><span class="op">(</span><span class="va">projected_just_dia</span>, <span class="va">fifth_comma_meantone</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.04915723</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Sherrill.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

